import{u as Y,p as T}from"./user-17fe6185.js";/* empty css                        *//* empty css                   *//* empty css                     *//* empty css                    *//* empty css                     *//* empty css               *//* empty css                 *//* empty css                  */import{d as G,a as P,r as b,P as H,j as g,f as Z,E as ee,S as le,Q as ae,R as oe,T as re,V as te,W as se,b as de,c as ie,a2 as ne,X as ue,g as U,h as V,B as l,m,w as t,p as _,i as o,L as me,Y as pe,o as d,a0 as k,C as c,J as R,K as A,A as ce,a1 as D}from"./index-a45fb3eb.js";const ve={class:"main-wrap history-wrap"},fe={class:"wrap-title flex-space"},ge=V("p",null,"服务器管理",-1),_e={class:"search-area"},ye={class:"dialog-footer"},Ee=G({__name:"serverManage",setup(be){let E=P({table:[]});const x=b();let p=b(!1),h=b(!1),C=b("新增服务器"),F=b(!1),r=P({dialogForm:{serverName:"",serverType:void 0,host:"",port:void 0,username:"",password:"",privateKey:"",id:void 0},serverTypeList:[{value:1,label:"Password"},{value:2,label:"PrivateKey"}],dialogFormRules:{serverName:[{required:!0,trigger:"blur",message:"请填写服务器名称!"}],serverType:[{required:!0,trigger:"blur",message:"请选择服务器认证类型!"}],host:[{required:!0,trigger:"blur",message:"请填写服务器主机地址!"}],port:[{required:!0,trigger:"blur",message:"请填写服务器端口!"}]},searchData:{id:void 0,serverName:"",host:"",serverType:void 0}});const w=Y();H(()=>{y()});function I(){C.value="新增服务器",p.value=!0,F.value=!0,N()}function K(){var i;let s=F.value?"/api/server/add":"/api/server/edit",a=F.value?"新增成功！":"修改成功！";(i=x.value)==null||i.validate(n=>{n&&(console.log("xinzeng-----------",r.dialogForm),T(w.protocolUrl+s,r.dialogForm).then(u=>{u.code===200?(g({message:a,type:"success"}),p.value=!1,y()):g({message:u.msg})}).catch(u=>{g({message:u})}))})}function L(s){C.value="修改服务器",F.value=!1,p.value=!0,r.dialogForm=s}function N(){var s;r.dialogForm={serverName:"",serverType:void 0,host:"",port:void 0,username:"",password:"",privateKey:"",id:void 0},(s=x.value)==null||s.clearValidate()}function M(s){D.confirm("确认删除此数据吗?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{T(w.protocolUrl+"/api/server/del",{id:s}).then(a=>{a.code===200?(g({message:"删除成功",type:"success"}),y()):g({message:a.msg})})}).catch(()=>{})}function y(){h.value=!0,T(w.protocolUrl+"/api/server/list",r.searchData).then(s=>{s.code===200&&(E.table=s.data),h.value=!1}).catch(s=>{g({message:s.msg}),h.value=!1})}function q(){r.searchData={id:void 0,serverName:"",host:"",serverType:void 0},y()}function j(){p.value=!1,N()}function $(s){T(w.protocolUrl+"/api/server/check",{id:Number(s)}).then(a=>{a.code==200?D.alert(a.msg,"服务器状况查看",{confirmButtonText:"确定"}):D.alert(a.msg,"服务器状况检查",{confirmButtonText:"确定"})}).catch(a=>{D.alert(a.msg,"服务器状况检查",{confirmButtonText:"确定"})})}return(s,a)=>{const i=Z,n=ee,u=le,B=ae,S=oe,J=re,v=te,O=se,f=de,Q=ie,W=ne,X=ue;return d(),U("div",ve,[V("div",fe,[ge,l(k).ApiServerAddPerm?(d(),m(i,{key:0,type:"primary",onClick:I},{default:t(()=>[c("新增")]),_:1})):_("",!0)]),V("div",_e,[o(J,{gutter:20,type:"flex",justify:"end"},{default:t(()=>[o(u,{span:5},{default:t(()=>[o(n,{modelValue:l(r).searchData.id,"onUpdate:modelValue":a[0]||(a[0]=e=>l(r).searchData.id=e),modelModifiers:{number:!0},placeholder:"服务器ID",size:"large",clearable:""},null,8,["modelValue"])]),_:1}),o(u,{span:5},{default:t(()=>[o(n,{modelValue:l(r).searchData.serverName,"onUpdate:modelValue":a[1]||(a[1]=e=>l(r).searchData.serverName=e),placeholder:"服务器名称",size:"large",clearable:""},null,8,["modelValue"])]),_:1}),o(u,{span:5},{default:t(()=>[o(n,{modelValue:l(r).searchData.host,"onUpdate:modelValue":a[2]||(a[2]=e=>l(r).searchData.host=e),placeholder:"服务器主机地址",size:"large",clearable:""},null,8,["modelValue"])]),_:1}),o(u,{span:5},{default:t(()=>[o(S,{modelValue:l(r).searchData.serverType,"onUpdate:modelValue":a[3]||(a[3]=e=>l(r).searchData.serverType=e),class:"m-2 w100",placeholder:"服务器验证类型",clearable:"",size:"large"},{default:t(()=>[(d(!0),U(R,null,A(l(r).serverTypeList,e=>(d(),m(B,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(u,{span:4,class:"flex-end"},{default:t(()=>[o(i,{type:"primary",onClick:y},{default:t(()=>[c("搜索")]),_:1}),o(i,{onClick:q,type:"primary",plain:""},{default:t(()=>[c("重置")]),_:1})]),_:1})]),_:1})]),me((d(),m(O,{data:l(E).table,style:{width:"100%"},border:""},{default:t(()=>[o(v,{prop:"ID",label:"服务器ID",align:"center",width:"90px"}),o(v,{prop:"serverName",label:"服务器名称",align:"center"}),o(v,{prop:"serverType",label:"服务器认证类型",align:"center"},{default:t(e=>[V("span",null,ce(e.row.serverType==1?"Password ":"PrivateKey"),1)]),_:1}),o(v,{prop:"host",label:"服务器主机地址",align:"center"}),o(v,{prop:"port",label:"服务器端口",align:"center"}),o(v,{prop:"username",label:"服务器登陆用户名",align:"center"}),o(v,{label:"操作",align:"center",width:"220"},{default:t(e=>[l(k).ApiServerCheckPerm?(d(),m(i,{key:0,type:"primary",size:"small",onClick:z=>$(e.row.ID)},{default:t(()=>[c("检查状况")]),_:2},1032,["onClick"])):_("",!0),l(k).ApiServerEditPerm?(d(),m(i,{key:1,type:"primary",size:"small",onClick:z=>L(e.row)},{default:t(()=>[c("修改")]),_:2},1032,["onClick"])):_("",!0),l(k).ApiServerDelPerm?(d(),m(i,{key:2,type:"primary",size:"small",onClick:z=>M(e.row.ID)},{default:t(()=>[c("删除")]),_:2},1032,["onClick"])):_("",!0)]),_:1})]),_:1},8,["data"])),[[X,l(h)]]),o(W,{modelValue:l(p),"onUpdate:modelValue":a[11]||(a[11]=e=>pe(p)?p.value=e:p=e),title:l(C),width:"50%"},{footer:t(()=>[V("span",ye,[o(i,{onClick:j},{default:t(()=>[c("取消")]),_:1}),o(i,{type:"primary",onClick:K},{default:t(()=>[c("确定")]),_:1})])]),default:t(()=>[o(Q,{model:l(r).dialogForm,ref_key:"dialogFormRef",ref:x,"label-position":"right","label-width":"150px",size:"large",rules:l(r).dialogFormRules},{default:t(()=>[o(f,{label:"服务器名称",prop:"serverName"},{default:t(()=>[o(n,{modelValue:l(r).dialogForm.serverName,"onUpdate:modelValue":a[4]||(a[4]=e=>l(r).dialogForm.serverName=e),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(f,{label:"服务器认证类型",prop:"serverType"},{default:t(()=>[o(S,{modelValue:l(r).dialogForm.serverType,"onUpdate:modelValue":a[5]||(a[5]=e=>l(r).dialogForm.serverType=e),class:"m-2 w100",placeholder:"请选择服务器认证类型",clearable:""},{default:t(()=>[(d(!0),U(R,null,A(l(r).serverTypeList,e=>(d(),m(B,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(f,{label:"服务器主机地址",prop:"host"},{default:t(()=>[o(n,{modelValue:l(r).dialogForm.host,"onUpdate:modelValue":a[6]||(a[6]=e=>l(r).dialogForm.host=e),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(f,{label:"服务器端口",prop:"port"},{default:t(()=>[o(n,{modelValue:l(r).dialogForm.port,"onUpdate:modelValue":a[7]||(a[7]=e=>l(r).dialogForm.port=e),modelModifiers:{number:!0},autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(f,{label:"服务器登陆用户名",prop:"username"},{default:t(()=>[o(n,{modelValue:l(r).dialogForm.username,"onUpdate:modelValue":a[8]||(a[8]=e=>l(r).dialogForm.username=e),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(r).dialogForm.serverType===1?(d(),m(f,{key:0,label:"服务器登陆密码",prop:"password"},{default:t(()=>[o(n,{modelValue:l(r).dialogForm.password,"onUpdate:modelValue":a[9]||(a[9]=e=>l(r).dialogForm.password=e),autocomplete:"off"},null,8,["modelValue"])]),_:1})):_("",!0),l(r).dialogForm.serverType===2?(d(),m(f,{key:1,label:"服务器ssh secret",prop:"privateKey"},{default:t(()=>[o(n,{modelValue:l(r).dialogForm.privateKey,"onUpdate:modelValue":a[10]||(a[10]=e=>l(r).dialogForm.privateKey=e),autosize:{minRows:2,maxRows:4},type:"textarea",rows:3},null,8,["modelValue"])]),_:1})):_("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Ee as default};
