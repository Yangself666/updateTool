import{u as N,p as d}from"./user-26c67f18.js";/* empty css                          *//* empty css                    */import{d as M,a as B,r as b,P as D,a3 as E,a4 as w,f as j,g as k,h as p,z as P,A as r,i as h,w as l,Y as A,m as L,p as R,K as q,j as S,o as i,B as u,I as T,J as z,a0 as F,u as G,_ as J}from"./index-91c4c1c2.js";const K={class:"main-wrap project-user-wrap"},Y={class:"wrap-title"},H={class:"bottom-btn flex-end"},O=M({__name:"userPermManage",setup(Q){const c=q(),_=G(),m=N();let e=B({table:[],checkedPerm:[],permList:[],tempPermList:[]}),o=b(!1),n=b(!0);D(()=>{v(),C()});function v(){d(m.protocolUrl+"/api/permission/list",{}).then(s=>{s.code===200&&(e.table=s.data)})}function C(){d(m.protocolUrl+"/api/user/userPermission",{id:Number(c.query.userId)}).then(s=>{if(s.code===200&&s.data.length>0){for(let t=0;t<s.data.length;t++)e.tempPermList.push(s.data[t].permissionName),e.permList.push(s.data[t].ID);e.checkedPerm=e.permList,e.checkedPerm.length==e.table.length?(n.value=!1,o.value=!0):o.value=!1}})}const y=s=>{if(e.table.length>0&&s==!0){e.permList=[];for(let t=0;t<e.table.length;t++)e.tempPermList.push(e.table[t].permissionName),e.permList.push(e.table[t].ID)}else e.permList=[];e.checkedPerm=e.permList,n.value=!1},x=s=>{const t=s.length;o.value=t===e.table.length,n.value=t>0&&t<e.table.length};function I(){d(m.protocolUrl+"/api/user/editPermission",{userId:Number(c.query.userId),permissionIdList:e.checkedPerm}).then(s=>{s.code==200&&(S({message:"绑定成功",type:"success"}),_.push("/userManage"))})}function U(){_.push("/userManage")}return(s,t)=>{const f=E,V=w,g=j;return i(),k("div",K,[p("div",Y,[p("p",null,P(r(c).query.name)+"-权限绑定管理",1)]),h(f,{modelValue:r(o),"onUpdate:modelValue":t[0]||(t[0]=a=>A(o)?o.value=a:o=a),indeterminate:r(n),onChange:t[1]||(t[1]=a=>y(r(o)))},{default:l(()=>[u(" 全部权限 ")]),_:1},8,["modelValue","indeterminate"]),h(V,{modelValue:r(e).checkedPerm,"onUpdate:modelValue":t[2]||(t[2]=a=>r(e).checkedPerm=a),onChange:x},{default:l(()=>[(i(!0),k(T,null,z(r(e).table,a=>(i(),L(f,{key:a.ID,label:a.ID},{default:l(()=>[u(P(a.permissionName),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),p("div",H,[h(g,{type:"primary",onClick:U,class:"mt35"},{default:l(()=>[u(" 返回 ")]),_:1}),r(F).ApiUserEditPermissionPerm?(i(),L(g,{key:0,type:"primary",onClick:I,class:"mt35"},{default:l(()=>[u(" 确定修改 ")]),_:1})):R("",!0)])])}}});const ee=J(O,[["__scopeId","data-v-ef1d0d7a"]]);export{ee as default};
