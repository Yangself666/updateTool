import{u as V,p as u}from"./user-4e4394e2.js";/* empty css                *//* empty css                     *//* empty css                 */import{d as E,r as U,a as k,E as S,b as B,c as C,e as R,f as q,g as L,h as e,i as l,w as i,n as N,j as g,l as d,o as f,k as M,m as j,p as z,q as P,u as A,s as D,_ as G}from"./index-6873b35d.js";const p=r=>(z("data-v-d8d0d82d"),r=r(),P(),r),H={class:"login-wrap"},J={class:"login-box flex-space"},K=p(()=>e("div",{class:"login-box-l"},null,-1)),O={class:"login-box-r"},Q={class:"login-div"},T={class:"login-part"},W=p(()=>e("div",{class:"login-head"},[e("div",{class:"login-text"},[e("h1",{class:"tl"},"欢迎登录"),e("p",null,"请使用已授权的账号密码登录")])],-1)),X={class:"login-form"},Y={class:"form-content"},Z={class:"confirm-btn flex-space"},$=p(()=>e("span",null,"点击登录",-1)),oo=E({__name:"login",setup(r){const a=V(),h=A(),_=U(),o=k({loginForm:{email:"",password:""},loginRules:{email:[{required:!0,trigger:"blur",message:"请输入帐号"}],password:[{required:!0,trigger:"blur",message:"请输入密码"}]},showloading:!1});function v(){var s;(s=_.value)==null||s.validate(t=>{t?(o.showloading=!0,a.login(o.loginForm).then(n=>{n.code===200&&w(),o.showloading=!1}).catch(n=>{g({message:n.msg}),o.showloading=!1})):o.showloading=!1})}function w(){u(a.protocolUrl+"/api/user/info",{}).then(s=>{s.code==200&&(a.userInfo=s.data,d.set("userInfo",s.data),I())}).catch(s=>{})}function I(){u(a.protocolUrl+"/api/user/permission",{}).then(s=>{if(s.code==200){let t=d.get("userInfo")?d.get("userInfo"):{};t.perm=s.data,d.set("userInfo",t),a.userInfo=t,h.push("/home"),g({message:"登录成功！",type:"success"})}})}return(s,t)=>{const n=S,m=B,b=C,x=D("Loading"),F=R,y=q;return f(),L("div",H,[e("div",J,[K,e("div",O,[e("div",Q,[e("div",T,[W,e("div",X,[e("div",Y,[l(b,{ref_key:"loginFormRef",ref:_,model:o.loginForm,rules:o.loginRules},{default:i(()=>[l(m,{prop:"email"},{default:i(()=>[l(n,{modelValue:o.loginForm.email,"onUpdate:modelValue":t[0]||(t[0]=c=>o.loginForm.email=c),placeholder:"账号"},null,8,["modelValue"])]),_:1}),l(m,{prop:"password"},{default:i(()=>[l(n,{modelValue:o.loginForm.password,"onUpdate:modelValue":t[1]||(t[1]=c=>o.loginForm.password=c),placeholder:"密码",type:"password"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),e("div",Z,[l(y,{class:"default-btn round-btn",disabled:o.showloading,style:N(o.showloading?"cursor:not-allowed!important":"cursor:pointer"),onClick:v},{default:i(()=>[o.showloading?(f(),M(F,{key:0,class:"is-loading"},{default:i(()=>[l(x)]),_:1})):j("",!0),$]),_:1},8,["disabled","style"])])])])])])])])])}}});const ao=G(oo,[["__scopeId","data-v-d8d0d82d"]]);export{ao as default};
