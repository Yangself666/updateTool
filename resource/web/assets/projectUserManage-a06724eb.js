import{u as N,p}from"./user-26c67f18.js";/* empty css                          *//* empty css                    */import{d as B,a as D,r as k,P as E,a3 as M,a4 as w,f as P,g as _,h as m,z as U,A as r,i as h,w as l,m as I,p as A,K as q,j as R,o as u,B as c,I as S,J as T,a0 as z,u as F}from"./index-91c4c1c2.js";const G={class:"main-wrap project-user-wrap"},J={class:"wrap-title"},K={class:"bottom-btn flex-end"},X=B({__name:"projectUserManage",setup($){const d=q(),f=F(),i=N();let e=D({table:[],checkedUser:[],userIdList:[],tempUserList:[]});const o=k(!1),n=k(!0);E(()=>{v(),L()});function v(){p(i.protocolUrl+"/api/user/list",{}).then(s=>{s.code===200&&(e.table=s.data)})}function L(){p(i.protocolUrl+"/api/project/user/list",{id:Number(d.query.projectId)}).then(s=>{if(s.code===200&&s.data.length>0){for(let t=0;t<s.data.length;t++)e.tempUserList.push(s.data[t].name),e.userIdList.push(s.data[t].ID);e.checkedUser=e.userIdList,e.checkedUser.length==e.table.length?(n.value=!1,o.value=!0):o.value=!1}})}const C=s=>{if(e.table.length>0&&s==!0){e.userIdList=[];for(let t=0;t<e.table.length;t++)e.tempUserList.push(e.table[t].name),e.userIdList.push(e.table[t].ID)}else e.userIdList=[];e.checkedUser=e.userIdList,n.value=!1},j=s=>{const t=s.length;o.value=t===e.table.length,n.value=t>0&&t<e.table.length};function y(){p(i.protocolUrl+"/api/project/user/edit",{projectId:Number(d.query.projectId),userIdList:e.checkedUser}).then(s=>{s.code==200&&(R({message:"绑定成功",type:"success"}),f.push("/resourceManage"))})}function V(){f.push("/resourceManage")}return(s,t)=>{const g=M,x=w,b=P;return u(),_("div",G,[m("div",J,[m("p",null,U(r(d).query.projectName)+"-用户绑定管理",1)]),h(g,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=a=>o.value=a),indeterminate:n.value,onChange:t[1]||(t[1]=a=>C(o.value))},{default:l(()=>[c(" 全部用户 ")]),_:1},8,["modelValue","indeterminate"]),h(x,{modelValue:r(e).checkedUser,"onUpdate:modelValue":t[2]||(t[2]=a=>r(e).checkedUser=a),onChange:j},{default:l(()=>[(u(!0),_(S,null,T(r(e).table,a=>(u(),I(g,{key:a.ID,label:a.ID},{default:l(()=>[c(U(a.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),m("div",K,[h(b,{type:"primary",onClick:V,class:"mt35"},{default:l(()=>[c(" 返回 ")]),_:1}),r(z).ApiProjectUserEditPerm?(u(),I(b,{key:0,type:"primary",onClick:y,class:"mt35"},{default:l(()=>[c(" 确定修改 ")]),_:1})):A("",!0)])])}}});export{X as default};
