import{u as V,p as u}from"./user-17fe6185.js";/* empty css                *//* empty css                     *//* empty css                 */import{d as E,u as U,r as k,a as S,E as R,b as B,c as C,e as L,f as q,g as N,h as e,i as l,w as i,n as M,j as g,l as d,k as P,o as f,m as j,p as z,q as A,s as D,t as G,_ as H}from"./index-a45fb3eb.js";const m=r=>(A("data-v-9cc438ea"),r=r(),D(),r),J={class:"login-wrap"},K={class:"login-box flex-space"},O=m(()=>e("div",{class:"login-box-l"},null,-1)),Q={class:"login-box-r"},T={class:"login-div"},W={class:"login-part"},X=m(()=>e("div",{class:"login-head"},[e("div",{class:"login-text"},[e("h1",{class:"tl"},"欢迎登录"),e("p",null,"请使用已授权的账号密码登录")])],-1)),Y={class:"login-form"},Z={class:"form-content"},$={class:"confirm-btn flex-space"},oo=m(()=>e("span",null,"点击登录",-1)),eo=E({__name:"login",setup(r){const n=V(),h=U(),p=k(),o=S({loginForm:{email:"",password:""},loginRules:{email:[{required:!0,trigger:"blur",message:"请输入帐号"}],password:[{required:!0,trigger:"blur",message:"请输入密码"}]},showloading:!1});function v(){var s;(s=p.value)==null||s.validate(t=>{t?(o.showloading=!0,n.login(o.loginForm).then(a=>{a.code===200&&w(),o.showloading=!1}).catch(a=>{g({message:a.msg}),o.showloading=!1})):o.showloading=!1})}function w(){u(n.protocolUrl+"/api/user/info",{}).then(s=>{s.code==200&&(n.userInfo=s.data,d.set("userInfo",s.data),I())}).catch(s=>{})}function I(){u(n.protocolUrl+"/api/user/permission",{}).then(s=>{if(s.code==200){let t=d.get("userInfo")?d.get("userInfo"):{};t.perm=s.data,d.set("userInfo",t),n.userInfo=t,P(s.data.permissionList),h.push("/home"),g({message:"登录成功！",type:"success"})}})}return(s,t)=>{const a=R,_=B,b=C,x=G("Loading"),F=L,y=q;return f(),N("div",J,[e("div",K,[O,e("div",Q,[e("div",T,[e("div",W,[X,e("div",Y,[e("div",Z,[l(b,{ref_key:"loginFormRef",ref:p,model:o.loginForm,rules:o.loginRules},{default:i(()=>[l(_,{prop:"email"},{default:i(()=>[l(a,{modelValue:o.loginForm.email,"onUpdate:modelValue":t[0]||(t[0]=c=>o.loginForm.email=c),placeholder:"账号"},null,8,["modelValue"])]),_:1}),l(_,{prop:"password"},{default:i(()=>[l(a,{modelValue:o.loginForm.password,"onUpdate:modelValue":t[1]||(t[1]=c=>o.loginForm.password=c),placeholder:"密码",type:"password"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),e("div",$,[l(y,{class:"default-btn round-btn",disabled:o.showloading,style:M(o.showloading?"cursor:not-allowed!important":"cursor:pointer"),onClick:v},{default:i(()=>[o.showloading?(f(),j(F,{key:0,class:"is-loading"},{default:i(()=>[l(x)]),_:1})):z("",!0),oo]),_:1},8,["disabled","style"])])])])])])])])])}}});const io=H(eo,[["__scopeId","data-v-9cc438ea"]]);export{io as default};
